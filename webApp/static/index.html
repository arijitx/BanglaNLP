<html>
    <head>
        <title>Bangla NLP | Curiosity AI</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
        <script async defer src="https://buttons.github.io/buttons.js"></script>
        <style>
            #btnSubmit,
            #btnSkip{
                display: inline-block;
                vertical-align: top;
            }
        </style>
        <script src="https://s3.amazonaws.com/stitch-sdks/js/bundles/4.6.0/stitch.js"></script>

    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="col-sm-4">
                    <br><br>
                    <div class="jumbotron">
                        <h3 class="display-4"><b><u>Instructions</u></b></h3>
                        <small>Write the bengali transliteration of the word in the textbox and submit, click skip if you want to skip</small>
                        <hr class="my-4">
                        <b>
                        <div class="list-group">
                          <a href="#" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                              <h5 class="mb-1">কবিতা </h5>

                            </div>
                            <p><b><small class="text-success">kobita
                            <svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                            </svg>
                            </small></b></p>
                            <p><b><small class="text-danger">poem
                            <svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                              <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                            </svg>
                            </small></b></p>
                          </a>
                          <a href="#" class="list-group-item list-group-item-action">
                            <div class="d-flex w-100 justify-content-between">
                              <h5 class="mb-1">বাজার</h5>

                            </div>
                            <p><b><small class="text-success">bajar
                            <svg class="bi bi-check" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 010 .708l-7 7a.5.5 0 01-.708 0l-3.5-3.5a.5.5 0 11.708-.708L6.5 10.293l6.646-6.647a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                            </svg>
                            </small></b></p>
                            <p><b><small class="text-danger">market
                            <svg class="bi bi-x" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 010 .708l-7 7a.5.5 0 01-.708-.708l7-7a.5.5 0 01.708 0z" clip-rule="evenodd"/>
                              <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 000 .708l7 7a.5.5 0 00.708-.708l-7-7a.5.5 0 00-.708 0z" clip-rule="evenodd"/>
                            </svg>
                            </small></b></p>
                          </a>

                        </div>
                        </b>

                    </div>
                </div>
                <div class="col-sm-4">
                <center>
                    <br><br><br>
                    <h1 id="bn_text"><b>{{ word }}</b></h1>
                    <br><br>
                    <input id="en_text" type="text" class="form-control" placeholder="Word in English">
                    <br>
                    <button id="btnSkip" class="btn btn-primary btn-md center-block">Skip</button>
                    <button id="btnSubmit" class="btn btn-success btn-md center-block" >Submit</button>
                    <br><br><br>
                    <span id="loading">Submitting ...</span>
                </center>
              </div>
              <div class="col-sm-4">
                  <br><br>
                    <div class="jumbotron">
                        <h3 class="display-4"><b><u>Dataset</u></b></h3>
                        <small>Dataset will be available in this Github <a href="https://github.com/arijitx/BanglaNLP">repository.</a></small><br/>
                        <!--<small>If you want to contribute drop a mail arijitmukh007@gmail.com</small>-->
                        <br>
                        <a class="github-button" href="https://github.com/arijitx/BanglaNLP/subscription" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="octicon-eye" data-show-count="true" aria-label="Watch arijitx/BanglaNLP on GitHub">Watch</a>
                        <a class="github-button" href="https://github.com/arijitx/BanglaNLP" data-color-scheme="no-preference: light; light: light; dark: dark;" data-icon="octicon-star" data-show-count="true" aria-label="Star arijitx/BanglaNLP on GitHub">Star</a>

                        <br><br>
                        <button class="btn btn-primary" type="button">
                         Your contribution <span id="your_contrib" class="badge"></span>
                        </button>
                        <br><br>
                        <br>
                        <button class="btn btn-primary" type="button">
                         Goal <span id="tot_words" class="badge"></span>
                        </button>
                        <br><br>
                        <div class="progress">
                          <div id="prog" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" >
                          </div>
                        </div>

                        <!--<p><b><small><span id="your_contrib" class="glyphicon glyphicon-fire text-success" aria-hidden="true"></span></p></b></small>-->

                    </div>

                    </div>
              </div>
            </div>
        <div class="row>
                    <br><br><br>
                    <div class="col-sm-12">
                    <iframe style="background: #21313C;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);" width="640" height="480" src="https://charts.mongodb.com/charts-project-0-kubbr/embed/charts?id=86295cbd-924f-454a-8844-3abaa5fd9836&autorefresh=1800&theme=dark"></iframe>
                    </div>
        </div>
        </div>
        <script>
            const client = stitch.Stitch.initializeDefaultAppClient('bntransserve-fhipn');

            function isEmpty(str) {
                return (!str || !str.trim() || 0 === str.trim().length);
            }

            function onClickHandler() {
                // const client = stitch.Stitch.initializeDefaultAppClient('bntransserve-fhipn');
                if(!isEmpty($('#en_text').val()) && !isEmpty($('#bn_text').text())) {
                  $("#loading").show();
                  const db = client.getServiceClient(stitch.RemoteMongoClient.factory, 'mongodb-atlas').db('trans');

                  client.auth.loginWithCredential(new stitch.AnonymousCredential()
                  ).then(user =>
                      db.collection('bn').updateOne({owner_id: client.auth.user.id}, {$push:{ words :{en: $('#en_text').val(),bn: $('#bn_text').text()}}}, {upsert:true})
                  ).then(function(){
                    //   db.close();
                    
                      location.reload();
                  }).catch(err => {
                  console.error(err)
                  });
                }
                
            }

            $(document).ready(function(){
                $("#loading").hide();
                const db = client.getServiceClient(stitch.RemoteMongoClient.factory, 'mongodb-atlas').db('trans');

                client.auth.loginWithCredential(new stitch.AnonymousCredential()).then(user =>
                    db.collection('contrib_by_owner').find({owner_id: client.auth.user.id}, { limit: 100}).asArray()
                ).then(docs => {
                    console.log("Found docs", docs[0]["count"])
                    $("#your_contrib").text(docs[0]["count"])
                }).catch(err => {
                    console.error(err)
                });

                client.auth.loginWithCredential(new stitch.AnonymousCredential()).then(user =>
                    db.collection('total_words').find().asArray()
                ).then(docs => {
                    // console.log("Found docs", docs)
                    $("#tot_words").text(docs[0]['total']+" / 10,000");
                    var valeur = parseInt(docs[0]['total'])/100;
                    $("#prog").attr("aria-valuenow",valeur).css('width', valeur+'%');
                }).catch(err => {
                    console.error(err)
                });
            });
            
            $("#loading").hide();
            $("#btnSkip").click(function(){
                location.reload();
            });
            $("#btnSubmit").click(onClickHandler);
            $("#en_text").keydown(function(event){
              if(event.keyCode === 27) {
                location.reload();
              } else if (event.keyCode === 13) {
                onClickHandler();
              }
            });
        </script>
    </body>
</html>
